<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Hábitos | EvolvP</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:system-ui,sans-serif;}
html,body{height:100%;overflow:hidden;}
body{background:#f4f6f8;}

/* TOP BAR */
.top-bar{
  height:110px;
  background:linear-gradient(135deg,#4CAF50,#66bb6a);
  color:white;
  padding:24px;
  border-radius:0 0 24px 24px;
  display:flex; flex-direction:column; justify-content:center;
}
.top-bar h1{font-size:22px;}
.top-bar p{font-size:14px;opacity:.9;margin-top:4px;}

/* CONTENT */
.content{
  height:calc(100% - 110px - 84px);
  overflow-y:auto;
  padding:16px;
}

/* PANEL COMPACTO */
.panel{
  position:fixed;
  bottom:-100%;
  left:0; right:0;
  max-height:70%;
  background:white;
  border-radius:24px 24px 0 0;
  padding:20px;
  transition:.3s;
  z-index:20;
  display:flex;
  flex-direction:column;
  overflow-y:auto;
}
.panel.active{bottom:0;}
.panel-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:16px;
}
.panel-header h3{font-size:20px;}
.panel-header i{font-size:22px; cursor:pointer;}

/* FORM ELEMENTS */
input, select{
  padding:10px;
  border-radius:12px;
  border:1px solid #ccc;
  font-size:15px;
}

label{
  font-weight:600;
  margin-bottom:6px;
  display:block;
}

.options{
  display:flex;
  flex-direction:column;
  gap:10px;
  margin-bottom:16px;
}

.option-card{
  border:1px solid #ddd;
  border-radius:14px;
  padding:10px 14px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  cursor:pointer;
  transition:0.2s;
}
.option-card:hover{background:#f0f0f0;}

.option-inputs{
  display:flex;
  gap:8px;
}

/* BUTTONS */
button{
  padding:12px 18px;
  border:none;
  border-radius:12px;
  font-weight:600;
  font-size:16px;
  cursor:pointer;
}
.confirm{background:#4CAF50;color:white;width:100%; margin-bottom:8px;}
.cancel{background:#ccc;width:100%;}

/* ADD BUTTON */
.add-btn{
  position:fixed;
  right:20px;
  bottom:110px;
  width:50px;height:50px;
  border-radius:50%;
  background:#4CAF50;
  color:white;
  font-size:24px;
  display:flex;align-items:center;justify-content:center;
}

/* BOTTOM BAR */
.bottom-bar{
  height:84px;
  position:fixed;
  bottom:0;left:0;right:0;
  background:rgba(255,255,255,.95);
  display:flex;
  justify-content:space-around;
  align-items:center;
  box-shadow:0 -6px 20px rgba(0,0,0,.15);
}
.bottom-bar a{font-size:22px;color:#888;}
.bottom-bar a.active{color:#4CAF50;}

/* HABIT CARD */
.habit-card{
  background:white;
  border-radius:18px;
  padding:14px;
  margin-bottom:12px;
  box-shadow:0 6px 16px rgba(0,0,0,.1);
}
.habit-card small{color:#666;}
.actions{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap;}
.edit{background:#2196F3;color:white;}
.pause{background:#444;color:white;}
.delete{background:#f44336;color:white;}
</style>
</head>

<body>

<div class="top-bar">
  <h1>Hábitos</h1>
  <p>Crear, editar, pausar o eliminar</p>
</div>

<div class="content" id="habitList"></div>

<div class="add-btn" onclick="openCreate()">
  <i class="fas fa-plus"></i>
</div>

<!-- PANEL NUEVO HÁBITO -->
<div class="panel" id="createPanel">
  <div class="panel-header">
    <h3>Nuevo hábito</h3>
    <i class="fas fa-times" onclick="closePanels()"></i>
  </div>

  <label>Nombre del hábito</label>
  <input id="habitName" placeholder="Ej: Meditar, Leer, Hacer ejercicio">

  <label>Categoría</label>
  <select id="habitCat">
    <option>Salud</option>
    <option>Ejercicio</option>
    <option>Estudio</option>
    <option>Sueño</option>
    <option>Disciplina</option>
    <option>Social</option>
  </select>

  <p><b>Desde qué fecha empieza este hábito:</b></p>
  <div class="options">
    <div class="option-card">
      <span><input type="radio" name="range" value="today+" checked> Desde hoy en adelante</span>
    </div>
    <div class="option-card">
      <span><input type="radio" name="range" value="today"> Solo por hoy</span>
    </div>
    <div class="option-card">
      <span><input type="radio" name="range" value="between"> Desde una fecha hasta otra</span>
      <div class="option-inputs" style="display:none;">
        <input type="date" id="startDate">
        <input type="date" id="endDate">
      </div>
    </div>
    <div class="option-card">
      <span><input type="radio" name="range" value="from"> Desde una fecha en adelante</span>
      <div class="option-inputs" style="display:none;">
        <input type="date" id="fromDate">
      </div>
    </div>
  </div>

  <button class="confirm" onclick="createHabit()">Crear hábito</button>
  <button class="cancel" onclick="closePanels()">Cancelar</button>
</div>

<div class="bottom-bar">
  <a href="index.html"><i class="fas fa-house"></i></a>
  <a href="Calendario.html"><i class="fas fa-calendar"></i></a>
  <a href="HabitoHN.html"><i class="fas fa-check"></i></a>
  <a href="Consejos.html"><i class="fas fa-lightbulb"></i></a>
  <a href="AddH.html" class="active"><i class="fas fa-plus"></i></a>
  <a href="Ajustes.html"><i class="fas fa-gear"></i></a>
</div>

<script>
let habits=[];

const startDateDiv = document.querySelector("#startDate").parentNode;
const endDateDiv = document.querySelector("#endDate") ? document.querySelector("#endDate").parentNode : null;
const fromDateDiv = document.querySelector("#fromDate").parentNode;

document.querySelectorAll("input[name=range]").forEach(r=>{
  r.onchange=()=>{
    // ocultar todos
    document.querySelectorAll(".option-inputs").forEach(d=>d.style.display="none");
    // mostrar solo el correspondiente
    if(r.value==="between") r.closest(".option-card").querySelector(".option-inputs").style.display="flex";
    if(r.value==="from") r.closest(".option-card").querySelector(".option-inputs").style.display="flex";
  }
});

function openCreate(){createPanel.classList.add("active");}
function closePanels(){createPanel.classList.remove("active");}

function createHabit(){
  const name = document.getElementById("habitName").value;
  const cat = document.getElementById("habitCat").value;
  if(!name || !cat){ alert("Completa todo"); return;}
  habits.push({name:name, cat:cat, status:"Activo"});
  document.getElementById("habitName").value="";
  createPanel.classList.remove("active");
  render();
}

function render(){
  const habitList = document.getElementById("habitList");
  habitList.innerHTML="";
  habits.forEach((h,i)=>{
    habitList.innerHTML+=`
      <div class="habit-card">
        <strong>${h.name}</strong><br>
        <small>${h.cat} · ${h.status}</small>
        <div class="actions">
          ${h.status==="Activo"?`<button class="pause" onclick="pauseHabit(${i})">Pausar</button>`:`<button class="confirm" onclick="resumeHabit(${i})">Reanudar</button>`}
          <button class="edit">Editar</button>
          <button class="delete" onclick="deleteHabit(${i})">Eliminar</button>
        </div>
      </div>`;
  });
}

function pauseHabit(i){if(confirm("¿Seguro que querés pausar este hábito?")){habits[i].status="Pausado";render();}}
function resumeHabit(i){habits[i].status="Activo";render();}
function deleteHabit(i){if(confirm("¿Seguro que querés eliminar este hábito?")){habits.splice(i,1);render();}}
</script>

</body>
</html>
